# Malware Simulation – HTTP Tunneling (Python C2)

This simulation demonstrates how an attacker can establish covert **Command-and-Control (C2)** using an **HTTP tunnel**, bypassing basic firewalls and evading IDS tools like Suricata.

---

## Objective
- Simulate a persistent HTTP-based reverse shell that operates over port 80
- Allow full shell command execution and file transfers (upload/download)
- Test detection capability of Suricata IDS and Fortinet Firewall

---

## Files Involved

- `serverhttp_real.py` – C2 Server (attacker side)
- `victimhttp_real.py` – Client (victim machine)

> Location in repo:
```
CyberFortify-Fyp\simulations\malware\http_tunnel\
```

---

## Technique Summary

| Aspect           | Detail                                                   |
|------------------|----------------------------------------------------------|
| Protocol         | HTTP (port 80)                                           |
| Beacon Interval  | 20 seconds (configurable)                                |
| C2 Direction     | Victim → Attacker (via `/poll` and `/submit` endpoints) |
| Payload          | Commands and file data encoded with Base64               |
| Capabilities     | Shell execution, file upload/download                    |

---

## Workflow

1. **Victim** continuously polls `http://<attacker-ip>/poll` every 20s for commands.
2. **Attacker** injects commands using a Flask web server (`serverhttp_real.py`).
3. Victim executes commands and Base64-encodes results or files.
4. Output is POSTed to `/submit` and printed on attacker's terminal.

---

## Detection & Response

- **Suricata** detected repeated polling behavior as anomalous HTTP traffic
- **Fortinet Firewall** flagged unusual POST frequency to a suspicious listener
- Manual review revealed presence of encoded payloads and unauthorized access pattern

---

## Evidence Screenshot

> Screenshot of HTTP C2 reverse shell in action:


![HTTP Tunnel Shell](/assets/screenshots/http_tunnel/http_tunnel1.png)
![HTTP Tunnel Shell](/assets/screenshots/http_tunnel/http_tunnel2.png)
